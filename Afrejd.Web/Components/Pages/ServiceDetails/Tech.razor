@page "/IT&Tech"

@using Afrejd.Web.Data.Interfaces
@using Afrejd.Web.Data.Models
@using Afrejd.Web.Components.Layout
@inject ICartService CartService
@inject AuthenticationStateProvider AuthenticationStateProvider
@inject NavigationManager NavigationManager
@rendermode InteractiveServer

<PageTitle>IT & Tech</PageTitle>

<article>
    <MudContainer MaxWidth="MaxWidth.ExtraLarge" Class=" py-6">
        <MudPaper Outlined="true" Class="d-flex flex-column">
            <MudPaper Elevation="0" Width="100%" Class="d-flex flex-column flex-md-row justify-space-between pa-6">
                <MudStack Class="d-flex justify-start">
                    <h1 class="display-1">
                        IT & Tech
                    </h1>

                    <MudButton Variant="Variant.Filled" Size="Size.Medium" Style="background-color: #363732; color: white; width:fit-content;" @onclick="AddItemToCart">
                        Lägg i Varukorg
                    </MudButton>

                    <div>
                        @if (!string.IsNullOrEmpty(SuccessMessage))
                        {
                            <div class="alert alert-success" role="alert">
                                @SuccessMessage
                            </div>
                        }
                    </div>
                </MudStack>
                <MudPaper Elevation=0 Class="d-flex justify-content-end">
                    <MudImage Fluid="true" Class="rounded-xl" Src="/Images/stock17.jpg"></MudImage>
                </MudPaper>
            </MudPaper>
            <MudDivider DividerType="DividerType.Middle" Class="my-6" />

            <MudPaper Width="75%" Elevation=0 Style="margin:auto;">
                <h3>Skapa Anpassade IT-Lösningar Med Afrejd</h3>
                <MudText Class="mb-15" Style="font-size: 2em;">
                    Med vår egen IT-avdelning har Afrejd en betydande fördel när det gäller att erbjuda skräddarsydda IT-lösningar som passar varje kunds unika behov. 
                    Vi strävar efter att leverera hela värdekedjan av IT-tjänster, från rådgivning och etablering av webbutiker till integration av beställnings- och 
                    betalningslösningar samt affärssystem för redovisning och lagerhantering.
                </MudText>

                <MudText Class="mb-6">
                    Vi på Afrejd kan anpassa vår service för att antingen hantera hela IT-processen åt dig eller endast de delar du behöver stöd med. 
                    Vi är flexibla och lyhörda för våra kunders behov och strävar efter att erbjuda skräddarsydda lösningar som passar just dig. 
                    Genom att utnyttja avancerade prenumerationssystem och integrera med olika e-handelsplattformar kan vi skapa specialanpassade system som smidigt 
                    integreras med ditt befintliga IT-ekosystem. Vår kundportal erbjuder en anpassningsbar instrumentpanel där du kan övervaka allt från orderstatus till 
                    finansiella transaktioner medan våra system samverkar sömlöst med dina egna.
                </MudText>

                <MudText Class="mb-6">
                    Via Afrejd-kundportalen kan du enkelt få tillgång till rapporter om beställningar, lagerstatus och meddelanden från systemet. 
                    Varje användare kan anpassa sin instrumentpanel och välja vilken information de vill ta emot och när. Rapporter kan skickas via e-post, SMS eller direkt 
                    till kundens meddelandecenter på webbportalen.
                </MudText>

                <h3>Flexibla Kampanjsystem För Alla Behov</h3>
                <MudText Class="mb-6">
                    Afrejd erbjuder logistiklösningar till företag av alla storlekar, inklusive skräddarsydda kampanjsystem för stora multibutikskedjor. 
                    Genom att erbjuda flexibla reklamlösningar förenklar vi beställningsprocessen och ger ökad flexibilitet för användarna internt. 
                    På så sätt kan du fokusera på din kärnverksamhet medan vi tar hand om den tekniska infrastrukturen och optimerar den utifrån dina specifika behov.
                </MudText>

                <h3>Sömlös Övergång Till Nytt Logistiksystem</h3>
                <MudText Class="mb-6">
                    Att byta lager och logistiksystem behöver inte vara komplicerat. Vi erbjuder en smidig övergång med ett intuitivt användargränssnitt och omfattande 
                    integrationer med betalningslösningar och andra system. Afrejd utvecklar och anpassar IT-systemen efter dina önskemål och levererar en komplett 
                    paketlösning för både det fysiska och tekniska behovet. Med oss vid din sida kan du enkelt skicka varorna till oss och låta oss sköta resten.
                </MudText>
            </MudPaper>
        </MudPaper>
    </MudContainer>

    <ServicesPanel />
</article>


@code {
    private string SuccessMessage;
    private string ErrorMessage;
    private int ProductId = 6;

    private async Task AddItemToCart()
    {
        try
        {
            var authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
            var user = authState.User;

            if (user.Identity.IsAuthenticated)
            {
                var userId = await CartService.GetUserId();
                await CartService.AddItemToCart(ProductId, userId);
                SuccessMessage = "Tjänsten har lagts till i varukorgen!";
            }
            else
            {
                NavigationManager.NavigateTo("Account/Register");
            }
        }
        catch (ArgumentException ex)
        {
            ErrorMessage = ex.Message;
        }
        catch (Exception ex)
        {
            ErrorMessage = $"An error occurred while adding the product to the cart: {ex.Message}";
        }
    }
}